<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Moment.js Vuln Lab</title>
    <link rel="icon" type="image/x-icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/dark-theme.css">
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <h3>Moment.js Vuln Lab</h3>
        <h6><span class="text-muted">Ain't nobody got time for that!</span></h6>
        <a class="nav-link" href="/home">Home</a> |
        <a class="nav-link" href="/upload">Upload</a> |
        <a class="nav-link" href="/uploads">Uploads</a> |
        <a class="nav-link" href="/moment">Moment</a>
    </div>
</nav>

<!-- Main Content -->
<div class="container mt-4">
    <div class="card mt-3">
        <div class="card-body">
            <p class="card-text lead">The goal of this lab is to clarify the scope of Moment.js' path traversal vuln (CVE-2022-24785).</p>
            <h4>Notably, the following are true:</h4>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">Moment.js is a legacy project that is currently in maintenance mode, but it is still very pervasive..</li>
                <li class="list-group-item">Successful exploitation of CVE-2022-24785 can lead to RCE, if prerequisites are met.</li>
                <li class="list-group-item">The current patch does not appear effective.</li>
            </ul>
        </div>
    </div>

    <h4>Steps</h4>
    <ol class="list-group list-group-numbered">
        <li class="list-group-item">Skim the references. Regarding Retire.js, just know it is helpful for discovery.</li>
        <li class="list-group-item">Upload a JavaScript file <a href="/upload">here.</a></li>
        <li class="list-group-item">Note the path and <a href="/uploads">view uploaded files.</a></li>
        <li class="list-group-item">Exploit the path traversal vuln in Moment.js' locale <a href="/moment">here.</a></li>
    </ol>

    <h4>References</h4>
    <ul class="list-group list-group-flush">
        <li class="list-group-item">Retire.js burp extension: <a href="https://github.com/h3xstream/burp-retire-js" target="_blank">https://github.com/h3xstream/burp-retire-js</a></li>
        <li class="list-group-item">GitHub advisory: <a href="https://github.com/advisories/GHSA-8hfj-j24r-96c4" target="_blank">https://github.com/advisories/GHSA-8hfj-j24r-96c4</a></li>
        <li class="list-group-item">Moment.js locale docs: <a href="https://momentjs.com/docs/#/i18n/changing-locale/" target="_blank">https://momentjs.com/docs/#/i18n/changing-locale/</a></li>
        <li class="list-group-item">Weaksauce patch: <a href="https://github.com/moment/moment/commit/4211bfc8f15746be4019bba557e29a7ba83d54c5" target="_blank">https://github.com/moment/moment/commit/4211bfc8f15746be4019bba557e29a7ba83d54c5</a></li>
        <li class="list-group-item">Weaksauce patched file: <a href="https://github.com/moment/moment/blob/2.29.2/src/lib/locale/locales.js" target="_blank">https://github.com/moment/moment/blob/2.29.2/src/lib/locale/locales.js</a></li>
    </ul><br>
</div>

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
</body>
</html>
